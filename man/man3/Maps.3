.\" --------------------------------------
.\" Oberon System Documentation  AFB  5/91
.\" (c) University of Ulm, SAI, D-7900 Ulm
.\" --------------------------------------
.de Pg
.nf
.ie t \{\
.	sp 0.3v
.	ps 9
.	ft CW
.\}
.el .sp 1v
..
.de Pe
.ie t \{\
.	ps
.	ft P
.	sp 0.3v
.\}
.el .sp 1v
.fi
..
.TH Maps 3 "Oberon System"
.SH NAME
Maps \- map a stream into multiple diversions
.SH SYNOPSIS
.Pg
TYPE Stream = POINTER TO StreamRec;
TYPE StreamRec = RECORD (Streams.StreamRec) END;
.sp 0.5
PROCEDURE Open(VAR s: Streams.Stream);
PROCEDURE AddMap(s: Streams.Stream;
                 begin, end, offset: Streams.Count;
                 to: Streams.Stream);
PROCEDURE Valid(s: Streams.Stream; address: Streams.Count) : BOOLEAN;
.Pe
.SH DESCRIPTION
.I Maps
allows to map address ranges of a stream into other streams with
given offsets.
.I Maps.Stream
supports all stream operations except \fItrunc\fP
provided they are implemented by the underlying diversions.
\fIStreams.Close\fP does not cause any of the diversions to be closed.
.PP
.I Open
initializes the given stream.
As long no maps have been added all read or write operations will fail.
.PP
.I AddMap
adds the interval
.BI [ begin .. end )
to the set of legal address ranges.
An access to a byte inside of this interval is translated by
.I Maps
to an access of the stream \fIto\fP at
\fIoffset\fP \fB+\fP \fIcurrent position\fP \fB-\fP \fIbegin\fP.
If multiple maps have been added,
they are considered in the invocation order of \fIAddMap\fP.
.I Maps
differentiates between read and write accesses,
i.e. a read-only and a write-only stream may cover the same address range.
.PP
.I Valid
returns \fBTRUE\fP
if \fIaddress\fP is a valid address to read from.
.SH "SEE ALSO"
\fIStreams(3)\fP
.SH BUGS
.I Maps
does not check for common ranges of multiple maps.
.\" ---------------------------------------------------------------------------
.\" $Id: Maps.3,v 1.1 91/10/10 12:38:21 borchert Exp $
.\" ---------------------------------------------------------------------------
.\" $Log:	Maps.3,v $
.\" Revision 1.1  91/10/10  12:38:21  borchert
.\" Initial revision
.\" 
.\" ---------------------------------------------------------------------------
